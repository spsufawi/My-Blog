---
title: Understanding rnorm, dnorm, pnorm and qnorm
author: Xinchen Pan
date: '2018-05-01'
slug: rnorm-dnorm-pnorm-qnorm
categories:
  - Statistics
tags:
  - R
  - statistics
---



<p>I just use the normal distribution as an example in the title. The <code>d, p, q, r</code> are a family of functions for different distributions. Though we can understand the meaning of them after taking an introductory mathematical statistics course, sometimes they still look comfusing, especially for <code>p</code> and <code>q</code>.</p>
<p>Let’s start by two <code>d</code> and <code>r</code></p>
<div id="dnorm" class="section level2">
<h2>dnorm</h2>
<p>This <code>dnorm(x, mean = 0, sd = 1, log = FALSE)</code> function simply calculates the result for the value plugged into the probability density distribution.</p>
<p>So for the normal distribution with <span class="math inline">\(mean=0, sd=1\)</span>, we have</p>
<p><span class="math display">\[
\frac{1}{\sqrt{2\pi}}e^{\frac{-x^2}{2}}
\]</span></p>
<p>If we plug <span class="math inline">\(x=2\)</span> inside the pdf, we have</p>
<pre class="r"><code>1 / sqrt(2 * pi) * exp(-2^2 / 2)</code></pre>
<pre><code>## [1] 0.05399097</code></pre>
<p>which is the same as</p>
<pre class="r"><code>dnorm(x = 2, mean = 0, sd = 1)</code></pre>
<pre><code>## [1] 0.05399097</code></pre>
</div>
<div id="rnorm" class="section level2">
<h2>rnorm</h2>
<p><code>rnorm(n, mean = 0, sd = 1)</code> returns <em>n</em> random values that belong to the normal distribution with a <span class="math inline">\(mean=0\)</span> and <span class="math inline">\(sd=1\)</span>.</p>
<p>For example, for <span class="math inline">\(N(0,1)\)</span>, if we generate 100 values from it. It is very unlikely that we will get a value of 10000. In fact, we are able to get the probability of having a value of 10000 from this <span class="math inline">\(N(0,1)\)</span> distribution by using <code>pnorm</code>. Mostly we will have some values are not far from 0 depending on the standard deviation. The mean and sd we got from the randomly generately values will get close to the theoretical value as <em>n</em> gets larger. <a href="https://en.wikipedia.org/wiki/Law_of_large_numbers">Law of large numbers</a></p>
<pre class="r"><code>rnorm(100, mean = 0, sd = 1)</code></pre>
<pre><code>##   [1]  0.53733780 -1.26726102  2.12105285 -0.62334440 -0.05684327
##   [6] -1.74271212  0.59597316 -1.09798651 -0.96649115  1.64153012
##  [11]  0.20581524  0.91274917  0.56248934 -0.68116959 -0.53941118
##  [16] -0.09790362  0.83438127  1.38592868 -0.43422412  2.05253035
##  [21]  0.54374555 -0.66667777 -1.63589260 -1.99000597  0.06345511
##  [26]  0.32076344  2.11318559 -0.38087788  1.33215069  0.13964867
##  [31] -0.85863800  0.18896103  0.17721937 -0.10430913  0.20482003
##  [36] -0.21240116 -2.44646263  0.75968032  0.66643294  0.45333980
##  [41] -0.39776422 -0.66193321  0.07272410 -1.06887589 -0.91950281
##  [46] -0.63747808  0.85455405 -0.57537838  1.25314869  0.68972887
##  [51]  0.98806486 -0.61168820  1.39103460 -2.63425456 -0.37617289
##  [56]  0.23161684 -1.03716172  0.28703040 -1.00229445 -1.23621055
##  [61] -0.52168369 -0.87999434  0.45013862 -1.90009251  0.43794875
##  [66] -0.79837891 -1.65647252 -1.52253470 -0.87725300 -0.09236394
##  [71] -0.21733096 -2.38569876  1.84042299  0.84180153  0.05548661
##  [76]  0.72130592  2.07559210  0.11520608  0.68692602  0.62229949
##  [81]  1.21919655 -0.35038355 -1.71844634 -1.45953637  0.91065209
##  [86]  1.00780238 -1.03074020  0.74322256 -0.17555523  0.55525386
##  [91] -0.54125987  0.41029520  1.29773765  1.53972277 -1.31682127
##  [96] -0.66244584  0.33376986  0.35295379  0.24769777 -0.32078145</code></pre>
<pre class="r"><code>mean(rnorm(100, mean = 0, sd = 1))</code></pre>
<pre><code>## [1] 0.1282914</code></pre>
</div>
<div id="pnorm" class="section level2">
<h2>pnorm</h2>
<p><code>pnorm(q, mean = 0, sd = 1, lower.tail = TRUE, log.p = FALSE)</code> returns the probabality of <span class="math inline">\(p(X&lt;=x)\)</span> by default. If we set <code>low.tail = FALSE</code>, then it returns <span class="math inline">\(p(X&gt;x)=1-p(X&lt;=x)\)</span>.</p>
<p>Let’s look at an extreme example which is the one I mentioned above. What is the probability that <span class="math inline">\(p(X&lt;10000)\)</span> for <span class="math inline">\(N(0,1)\)</span>. It is almost certainly that it should be 1. In another word, <span class="math inline">\(p(x&lt;10000)\)</span> is 0. You can imagine the chance of having a human being whose height is 40m(<a href="https://en.wikipedia.org/wiki/Ultraman">ultraman</a>).</p>
<p>It is important to remember the function returns probability.</p>
<pre class="r"><code>pnorm(0, mean = 0, sd = 1)</code></pre>
<pre><code>## [1] 0.5</code></pre>
<pre class="r"><code>pnorm(10000, mean = 0, sd = 1)</code></pre>
<pre><code>## [1] 1</code></pre>
</div>
<div id="qnorm" class="section level2">
<h2>qnorm</h2>
<p><code>qnorm(p, mean = 0, sd = 1, lower.tail = TRUE, log.p = FALSE)</code> is the inverse of <code>pnorm</code>, so the parameter <code>p</code> inside the qnorm need to be within <span class="math inline">\([0,1]\)</span>.</p>
<pre class="r"><code>qnorm(0.999, mean=0, sd=1, lower.tail = TRUE)</code></pre>
<pre><code>## [1] 3.090232</code></pre>
<pre class="r"><code>pnorm(3.090232, mean=0, sd=1, lower.tail = TRUE)</code></pre>
<pre><code>## [1] 0.999</code></pre>
</div>
