---
title: Understanding rnorm, dnorm, pnorm and qnorm
author: Xinchen Pan
date: '2018-05-01'
slug: rnorm-dnorm-pnorm-qnorm
categories:
  - Statistics
tags:
  - R
  - statistics
---



<p>I just use the normal distribution as an example in the title. The <code>d, p, q, r</code> are a family of functions for different distributions. Though we can understand the meaning of them after taking an introductory mathematical statistics course, sometimes they still look comfusing, especially for <code>p</code> and <code>q</code>.</p>
<p>Let’s start by <code>dnorm</code> and <code>rnorm</code></p>
<div id="dnorm" class="section level2">
<h2>dnorm</h2>
<p>This <code>dnorm(x, mean = 0, sd = 1, log = FALSE)</code> function simply calculates the result for the value plugged into the probability density distribution.</p>
<p>So for the normal distribution with <span class="math inline">\(mean=0, sd=1\)</span>, we have</p>
<p><span class="math display">\[
\frac{1}{\sqrt{2\pi}}e^{\frac{-x^2}{2}}
\]</span></p>
<p>If we plug <span class="math inline">\(x=2\)</span> inside the pdf, we have</p>
<pre class="r"><code>1 / sqrt(2 * pi) * exp(-2^2 / 2)</code></pre>
<pre><code>## [1] 0.05399097</code></pre>
<p>which is the same as</p>
<pre class="r"><code>dnorm(x = 2, mean = 0, sd = 1)</code></pre>
<pre><code>## [1] 0.05399097</code></pre>
</div>
<div id="rnorm" class="section level2">
<h2>rnorm</h2>
<p><code>rnorm(n, mean = 0, sd = 1)</code> returns <em>n</em> random values that belong to the normal distribution with a <span class="math inline">\(mean=0\)</span> and <span class="math inline">\(sd=1\)</span>.</p>
<p>For example, for <span class="math inline">\(N(0,1)\)</span>, if we generate 100 values from it. It is very unlikely that we will get a value of 10000. In fact, we are able to get the probability of having a value of 10000 from this <span class="math inline">\(N(0,1)\)</span> distribution by using <code>pnorm</code>. Mostly we will have some values are not far from 0 depending on the standard deviation. The mean and sd we got from the randomly generately values will get close to the theoretical value as <em>n</em> gets larger. <a href="https://en.wikipedia.org/wiki/Law_of_large_numbers">Law of large numbers</a></p>
<pre class="r"><code>rnorm(100, mean = 0, sd = 1)</code></pre>
<pre><code>##   [1]  0.68691959  1.43690843  0.70479364 -0.87698043 -0.55833706
##   [6] -0.14415754  1.16357825 -0.78517169  0.22572501  0.37579383
##  [11]  0.72842546  1.03149772  0.12336830  1.51023176  0.91958382
##  [16]  0.47599951 -0.02030236 -0.35230087 -0.10687841 -1.32780979
##  [21] -1.07600363  0.59125210  1.35634088  0.69392307 -0.31626096
##  [26] -0.49247174  0.19378650  1.06969915  0.04410681 -0.35083014
##  [31]  2.15622359  0.49422628 -0.25775835  0.79639206  0.76428423
##  [36] -1.24167510  1.95444199 -0.23721087  1.50664724  0.22160180
##  [41] -0.53008508 -0.54727652  0.25971077 -0.81693605  1.42099370
##  [46]  1.15560058 -1.11201736  1.42423306  1.87934981  0.05366270
##  [51]  0.39605745  0.42666838 -0.68812868 -0.80140430 -1.24350111
##  [56]  0.47241335 -1.03157533  0.64683562  0.20227059 -0.06824106
##  [61]  0.07479738 -1.01225151 -1.21666787 -1.70370898 -0.50706527
##  [66] -0.40019635 -0.46623168 -0.71159498 -0.98356747 -1.21097734
##  [71]  0.04702062 -0.51593302 -1.31239143 -0.15028301 -0.98321962
##  [76] -0.58241216  1.28209556 -0.41797219 -0.84696299 -0.49316312
##  [81] -0.46997159 -0.55363990 -0.63283791 -1.49136528  0.12813817
##  [86] -0.22630617  0.86170772  0.02007570 -0.56599628 -0.90925735
##  [91] -1.74347326  0.82656646  0.41768364 -0.09815983 -1.27426982
##  [96]  0.37725091  0.91369184 -2.70724560  1.66228497  1.13435609</code></pre>
<pre class="r"><code>mean(rnorm(100, mean = 0, sd = 1))</code></pre>
<pre><code>## [1] -0.1186238</code></pre>
</div>
<div id="pnorm" class="section level2">
<h2>pnorm</h2>
<p><code>pnorm(q, mean = 0, sd = 1, lower.tail = TRUE, log.p = FALSE)</code> returns the probabality of <span class="math inline">\(p(X&lt;=x)\)</span> by default. If we set <code>low.tail = FALSE</code>, then it returns <span class="math inline">\(p(X&gt;x)=1-p(X&lt;=x)\)</span>.</p>
<p>Let’s look at an extreme example which is the one I mentioned above. What is the probability that <span class="math inline">\(p(X&lt;10000)\)</span> for <span class="math inline">\(N(0,1)\)</span>. It is almost certainly that it should be 1. In another word, <span class="math inline">\(p(x&lt;10000)\)</span> is 0. You can imagine the chance of having a human being whose height is 40m(<a href="https://en.wikipedia.org/wiki/Ultraman">ultraman</a>).</p>
<p>It is important to remember the function returns probability.</p>
<pre class="r"><code>pnorm(0, mean = 0, sd = 1)</code></pre>
<pre><code>## [1] 0.5</code></pre>
<pre class="r"><code>pnorm(10000, mean = 0, sd = 1)</code></pre>
<pre><code>## [1] 1</code></pre>
</div>
<div id="qnorm" class="section level2">
<h2>qnorm</h2>
<p><code>qnorm(p, mean = 0, sd = 1, lower.tail = TRUE, log.p = FALSE)</code> is the inverse of <code>pnorm</code>, so the parameter <code>p</code> inside the qnorm need to be within <span class="math inline">\([0,1]\)</span>.</p>
<pre class="r"><code>qnorm(0.999, mean=0, sd=1, lower.tail = TRUE)</code></pre>
<pre><code>## [1] 3.090232</code></pre>
<pre class="r"><code>pnorm(3.090232, mean=0, sd=1, lower.tail = TRUE)</code></pre>
<pre><code>## [1] 0.999</code></pre>
</div>
